<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>eSPACE | AI CHAT-BOX</title>
  <link rel="icon" type="image/png" href="emojis/male-astronaut (1).png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css"/>

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Poppins', sans-serif;
      color: white;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      overflow-x: hidden;
      position: relative;
    }

    body::before {
      content: "";
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: url("assets/bg5.jpg") no-repeat center center fixed;
      background-size: cover;
      z-index: -1;
      filter: brightness(0.4) contrast(1.3);
      transform: scale(1.2);
      animation: zoomOutBg 0.6s ease forwards;
    }

    @keyframes zoomOutBg { to { transform: scale(1); } }

    body > * {
      opacity: 0;
      transform: translateY(50px);
      animation: fadeUpBody 1s ease forwards;
      animation-delay: 0.2s;
    }

    @keyframes fadeUpBody { to { opacity: 1; transform: translateY(0); } }

    .chat-container {
      display: grid;
      grid-template-columns: 1fr 2fr;
      gap: 40px;
      width: 95%;
      max-width: 1600px;
      margin: 100px auto 20px auto;
      align-items: start;
      height: calc(100vh - 140px);
    }

    .side-panel { 
      display: flex; 
      flex-direction: column; 
      gap: 25px; 
      height: auto;
    }

    .glass-box {
      flex: 1;
      min-height: 220px;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      padding: 30px;
      background: transparent;
      border-radius: 25px;
      border: 1px solid rgba(255, 255, 255, 0.3);
    }

    .glass-box h2 {
      font-size: 1.8rem;
      color: #00faff;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .glass-box p {
      font-size: 1rem; 
      line-height: 1.5; 
      color: #b0f7ff;
    }

    .glass-box hr {
      border: none; 
      height: 2px; 
      background: linear-gradient(to right, transparent, #00faff, transparent);
      margin: 4px 0 8px 0; 
      border-radius: 1px;
    }

    .chat-box {
      display: flex;
      flex-direction: column;
      background: rgba(5, 10, 20, 0.2);
      border-radius: 25px;
      padding: 25px;
      backdrop-filter: blur(15px) saturate(180%);
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.1), inset 0 0 10px rgba(255, 255, 255, 0.05);
      height: 100%;
      min-height: 400px;
    }

    .messages {
      flex: 1;
      overflow-y: auto;
      margin-bottom: 20px;
      padding-right: 10px;
    }

    .messages p {
      padding: 14px 18px;
      margin-bottom: 12px;
      border-radius: 20px;
      font-size: 1rem;
      animation: msgFadeIn 0.3s ease;
      max-width: 80%;
      word-wrap: break-word;
    }

    .messages p.user {
      background: linear-gradient(135deg, #00ff33, #00fc7a);
      color: #000;
      align-self: flex-end;
    }

    .messages p.ai {
      background: linear-gradient(135deg, #0ecc8a, #006aff);
      color: #000;
      align-self: flex-start;
    }

    @keyframes msgFadeIn { 
      from { opacity: 0; transform: translateY(10px); } 
      to { opacity: 1; transform: translateY(0); } 
    }

    .input-area {
      display: flex;
      gap: 10px;
      padding: 8px;
      border-radius: 15px;
      background: rgba(0,0,0,0.35);
      border: 1px solid rgba(0,255,255,0.3);
      align-items: center;
    }

    .input-area input {
      flex: 1;
      padding: 14px 18px;
      border-radius: 15px;
      border: none;
      outline: none;
      font-size: 1rem;
      color: #fff;
      background: rgba(0,0,0,0.25);
    }

    .input-area input::placeholder { color: #b0f7ff; }

    .input-area button {
      padding: 14px 18px;
      border-radius: 15px;
      border: none;
      background: linear-gradient(45deg, #fdfdfd00, #3885dc00);
      color: #000;
      font-weight: 600;
      cursor: pointer;
      transition: 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .input-area button:hover { transform: scale(1.05); }

    .messages::-webkit-scrollbar { width: 8px; }
    .messages::-webkit-scrollbar-thumb { background: rgba(0,255,255,0.4); border-radius: 4px; }
    .messages::-webkit-scrollbar-track { background: rgba(0,0,0,0.1); }

    @media(max-width: 1024px) {
      .chat-container { grid-template-columns: 1fr; gap: 30px; margin-top: 140px; }
      .messages { max-height: 400px; }
      .glass-box { min-height: 180px; max-height: 220px; }
    }

    @keyframes speakingWave {
      0% { opacity: 0.3; }
      50% { opacity: 1; }
      100% { opacity: 0.3; }
    }

    .speaking-effect::after {
      content: " ðŸŽ¤ Listening...";
      animation: speakingWave 1s infinite;
      color: #fafafa;
      font-weight: 600;
    }
  </style>
</head>
<body>

  <header>
    <div class="logo"><span>e</span><span>SPACE</span></div>
    <nav class="nav-glass-panel">
      <ul class="desktop">
        <li><a href="index.html">Dashboard</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="releases.html">Releases</a></li>
      </ul>
    </nav>
    <div class="menu-toggle" onclick="toggleMenu()">
      <span></span><span></span><span></span>
    </div>
  </header>

<main class="chat-container">
  <div class="side-panel">
    <div class="glass-box">
      <h2>eSPACE AI Bot <img src="assets/male-astronaut.png" style="width:1.5em;"></h2>
      <hr>
      <p style="font-size:0.85rem; line-height:1.35; color:#a8e7ff;">
         An <strong>intelligent, programmed AI assistant</strong> built into your space dashboard.  
         Designed to <em>understand, guide, and interact</em> with users in real-time, the eSPACE AI Bot 
         brings futuristic communication to your fingertips.
    </p>
    </div>
    <div class="glass-box">
      <h2>About <img src="emojis/speaking_head_in_silhouette (1).png" style="width:1.5em;"></h2>
<p style="font-size:0.85rem; line-height:1.35; color:#a8e7ff;">
  The eSPACE AI Bot is more than a chatbot â€” itâ€™s a <strong>smart companion</strong> engineered 
  to deliver quick answers, personalized guidance, and seamless navigation across the platform.  
  It adapts to queries about <strong>space missions, releases, updates</strong>, and even acts as a 
  friendly guide for exploration.
</p>
</div>
</div>
 <div class="chat-box">
      <div class="messages" id="messages">
        <p class="ai">
          <img src="assets/male-astronaut.png" style="width:20px; vertical-align:middle; margin-right:6px;">
          <b>AI:</b> Hello! Ask Me Anything.
        </p>
      </div>
      <div class="input-area">
        <input type="text" id="userInput" placeholder="Type a message...">
        <button onclick="startVoice()">
          <img src="favicon/3335861-200.png" style="width:2.9em; vertical-align:middle;">
        </button>
        <button onclick="sendMessage()">
          <img src="emojis/PhotoshopPreview_Image (1).png" style="width:2.8em; vertical-align:middle;">
        </button>
      </div>
    </div>
  </main>

  <script>
    const API_URL = "ADD YOUR BACKEND LINKapi/chat";
    let typingInProgress = false;

    function scrollToBottom() {
      const messages = document.getElementById("messages");
      messages.scrollTo({ top: messages.scrollHeight, behavior: "smooth" });
    }

    async function sendMessage() {
      if (typingInProgress) return;

      const input = document.getElementById("userInput");
      const text = input.value.trim();
      if (!text) return;

      const messages = document.getElementById("messages");

      // User message
      const userMsg = document.createElement("p");
      userMsg.classList.add("user");
      userMsg.innerHTML = `<b>You:</b> ${text}`;
      messages.appendChild(userMsg);
      scrollToBottom();
      input.value = "";

      // AI placeholder
      const aiMsg = document.createElement("p");
      aiMsg.classList.add("ai");
      aiMsg.innerHTML = `<img src="assets/male-astronaut.png" style="width:20px; vertical-align:middle; margin-right:6px;"><b>AI:</b> Typing...`;
      messages.appendChild(aiMsg);
      scrollToBottom();
      typingInProgress = true;

      let coldStartTimer = setTimeout(() => {
        aiMsg.innerHTML = `<img src="assets/male-astronaut.png" style="width:20px; vertical-align:middle; margin-right:6px;"><b>AI:</b> Server is cold starting... please wait.`;
        scrollToBottom();
      }, 7000);

      try {
        const response = await fetch(API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: text })
        });

        clearTimeout(coldStartTimer);
        if (!response.ok) throw new Error("Server error");

        const data = await response.json();
        aiMsg.innerHTML = `<img src="assets/male-astronaut.png" style="width:20px; vertical-align:middle; margin-right:6px;"><b>AI:</b> ${data.reply}`;
        scrollToBottom();
      } catch(err) {
        clearTimeout(coldStartTimer);
        aiMsg.innerHTML = `<img src="assets/male-astronaut.png" style="width:20px; vertical-align:middle; margin-right:6px;"><b>AI:</b> Server is turned off.`;
        scrollToBottom();
      } finally {
        typingInProgress = false;
      }
    }

    document.getElementById("userInput").addEventListener("keydown", function(event){
      if(event.key === "Enter") { event.preventDefault(); sendMessage(); }
    });

    function startVoice() {
      const input = document.getElementById("userInput");
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

      if (!SpeechRecognition) {
        alert("Your browser does not support Speech Recognition.");
        return;
      }

      const recognition = new SpeechRecognition();
      recognition.lang = "en-US";
      recognition.interimResults = true;
      recognition.maxAlternatives = 1;

      input.placeholder = "ðŸŽ¤ Speaking...";
      input.classList.add("speaking-effect");
      recognition.start();

      recognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript;
        input.value = transcript;
      };

      recognition.onspeechend = () => {
        recognition.stop();
        input.placeholder = "Type a message...";
        input.classList.remove("speaking-effect");
      };

      recognition.onerror = () => {
        input.placeholder = "Type a message...";
        input.classList.remove("speaking-effect");
        alert("Voice input error. Please try again.");
      };
    }
  </script>
</body>
</html>
